machine:
  services:
    - docker

dependencies:
  override:
    - docker build --force-rm --no-cache --pull -t experimentalplatform/ubuntu:$CIRCLE_BRANCH .

test:
  override:
    - "echo 'TODO: Insert some tests here?'"

deployment:
  latest:
    branch: latest
    commands:
      - docker login -e $DOCKER_EMAIL -u $DOCKER_USER -p $DOCKER_PASS
      - docker push experimentalplatform/ubuntu:$CIRCLE_BRANCH
